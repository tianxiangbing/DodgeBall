{"version":3,"sources":["game.ts"],"names":[],"mappings":"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","file":"game.js","sourcesContent":["/// <reference path=\"sprite.ts\" />\r\n/// <reference path=\"stage.ts\" />\r\n//游戏主框架\r\nenum STATE{\r\n    loading,\r\n    title,\r\n    descript,\r\n    newGame,\r\n    running,\r\n    pause,\r\n    levelUp,\r\n    die,\r\n    gameOver\r\n}\r\nclass Game{\r\n    private func:Function=new Function;\r\n    private timer:any;\r\n    private currentState:STATE;\r\n    protected interval:number=20;\r\n    constructor(public view,public stage:Stage){\r\n        console.log(this.view)\r\n        this.currentState=STATE.loading;\r\n        this.setState(STATE.loading);\r\n    }\r\n    createStage(){\r\n        console.log(this.stage)\r\n        this.view.appendChild(this.stage.create())\r\n    }\r\n    run(){\r\n        console.log('run')\r\n        //this.func();\r\n        this.createStage();//创建舞台\r\n        this.setState(STATE.newGame);\r\n    }\r\n    //加载\r\n    loading(){\r\n        this.setState(STATE.title)\r\n    }\r\n    //标题\r\n    title(){\r\n        console.log('title')\r\n    }\r\n    //说明\r\n    descript(){\r\n        console.log('descript')\r\n        this.setState(STATE.descript)\r\n    }\r\n    //新的开始\r\n    protected newGame(){\r\n        //游戏开始，清空场景\r\n        //打开计时器\r\n        this.setState(STATE.running);\r\n        this.startTimer();\r\n    }\r\n    //结束 \r\n    protected over(){\r\n        this.setState(STATE.gameOver);\r\n    }\r\n    //暂停\r\n    protected pause(){\r\n        this.stopTimer();\r\n    }\r\n    //暂停后的继续\r\n    protected play(){\r\n        this.startTimer();\r\n    }\r\n    //游戏结束\r\n    protected gameOver(){\r\n        //游戏结束\r\n        //清空场景，显示结果\r\n        console.log('gameOver');\r\n        this.stopTimer();\r\n    }\r\n    //停止刷新\r\n    stopTimer(){\r\n        clearInterval(this.timer);\r\n    }\r\n    //刷新帧\r\n    startTimer(){\r\n        let _this = this;\r\n        this.timer = setInterval(function(){\r\n            _this.func.bind(_this)();\r\n        },this.interval)\r\n    }\r\n    //游戏中的\r\n    running(){\r\n        console.log('running...')\r\n    }\r\n    //检查状态\r\n    checkState(){\r\n        switch (this.currentState) {\r\n            case STATE.loading:\r\n                this.func = this.loading;\r\n                break;   \r\n            case STATE.title:\r\n                this.func = this.title;\r\n                break;\r\n            case STATE.descript:\r\n                this.func = this.descript;\r\n                break;\r\n            case STATE.newGame:\r\n                this.func = this.newGame;\r\n                break;\r\n            case STATE.running:\r\n                this.func = this.running;\r\n                break;\r\n            case STATE.gameOver:\r\n                this.func = this.gameOver;\r\n            default:\r\n                break;\r\n        }\r\n    }\r\n    setState(state?:STATE){\r\n        this.currentState = state;\r\n        this.checkState();\r\n        this.func();\r\n    }\r\n}"]}